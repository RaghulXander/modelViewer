!function(e,t,s,n,r,o,a,i,l,c,d,u,m,p){"use strict";function h(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(s){if("default"!==s){var n=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:function(){return e[s]}})}})),t.default=e,Object.freeze(t)}var x=h(l);const f=()=>e.jsx(n.Helmet,{children:e.jsx("script",{type:"module",src:"https://ajax.googleapis.com/ajax/libs/model-viewer/3.0.1/model-viewer.min.js"})}),g=({withAr:t,url:s})=>e.jsxs(e.Fragment,{children:[e.jsx(f,{}),e.jsx("div",{id:"google-model-viewer",className:"h-screen w-full",children:e.jsx("model-viewer",{class:"w-full h-[70vh]",src:s,"ios-src":"",poster:"7",alt:"A 3D model of an astronaut","shadow-intensity":"1","camera-controls":!0,"auto-rotate":!0,ar:t})})]}),j=()=>{const[s,n]=t.useState("sunset");return t.useTransition(),e.jsx(c.Environment,{preset:s,background:!0,blur:.65})};function v(...e){return u.twMerge(d.clsx(e))}const b=t=>{const{progress:s=0,size:n=120,stokeSize:r=12,progresTextsClassName:o,circleClassName:a,backgroundCircleClassName:i}=t,l=(n-20)/2,c=2*Math.PI*l,d=c-s/100*c,u=`w-${n/4} h-${n/4}`;return e.jsx("div",{className:v("relative",u,i),"data-testid":"progress-circle",children:e.jsxs("svg",{className:"w-full h-full",viewBox:`0 0 ${n} ${n}`,children:[e.jsx("circle",{className:v("text-slate-200 stroke-current",a),strokeWidth:r,cx:n/2,cy:n/2,r:l,fill:"transparent"}),e.jsx("circle",{className:v("text-primary-default stroke-current",a),strokeWidth:r,strokeLinecap:"round",cx:n/2,cy:n/2,r:l,fill:"transparent",strokeDasharray:c,strokeDashoffset:d,transform:"rotate(-90, 60, 60)"}),e.jsxs("text",{x:n/2,y:n/2,className:v("text-lg font-normal font-['Plus Jakarta Sans']",o),textAnchor:"middle",alignmentBaseline:"middle",children:[s,"%"]})]})})},w=()=>{const{progress:s}=c.useProgress();return t.useEffect((()=>{const e=setInterval((()=>{console.log(`Progress: ${s}%`)}),1e3);return()=>{clearInterval(e)}}),[s]),0===parseInt(s.toFixed(0))?null:e.jsx(c.Html,{center:!0,children:e.jsx(b,{progress:parseInt(s.toFixed(2))})})},y=m(),k=({options:s,selectedOption:n,onSelect:r})=>{const[o,a]=t.useState(!1),[i]=t.useState("top"),l=t.useRef(null);return t.useEffect((()=>{function e(e){l.current&&!l.current.contains(e.target)&&a(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{onClick:()=>a(!o),className:"border border-gray-800 rounded-lg bg-gray-900 text-white cursor-pointer flex justify-center items-center px-4 py-2 outline-none",children:[n,e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2 inline-block transition-transform transform "+(o?"rotate-180":""),viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 10l5 5 5-5"})})]}),o&&e.jsx("div",{ref:l,className:`absolute ${"bottom"===i?"-top-[210%]":"bottom-[110%]"} left-0 mt-1 w-full bg-gray-800 rounded-md shadow-lg`,children:s.map((t=>e.jsx("div",{onClick:()=>(e=>{r(e),a(!1)})(t),className:"px-4 py-2 cursor-pointer hover:bg-gray-700 text-white border-b-2 last:border-0 rounded-lg",children:t},t)))})]})},S=({mixer:s,animations:n,playAction:r,setAnimationSpeed:o,animationSpeed:a,anims:i})=>{const c=["empty",...n],[d,u]=t.useState(!1),[m,p]=t.useState(0),[h,x]=t.useState(0),[f,g]=t.useState(1),[j,v]=t.useState(c[0]),b=new l.Clock;t.useEffect((()=>{const e=()=>{if(d){const e=b.getDelta();s.update(e)}requestAnimationFrame(e)};e()}),[d,s]),t.useEffect((()=>{const e=setInterval((()=>{if(d){const e=s.time,t=s._actions[0]._clip.duration;p(e/t*100)}}),1e3/60);return()=>clearInterval(e)}),[d,s]);return e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("button",{className:"bg-blue-700 hover:bg-gray-900 text-white font-bold py-2 px-4 rounded",onClick:()=>{u(!d),d?(s.timeScale=0,r(j,!1)):(s.timeScale=1,r(j,!0))},children:d?"Pause":"Play"}),e.jsx(k,{options:c,onSelect:e=>{v(e);const t=n.find((t=>t.name===e));t&&g(t.duration)},selectedOption:j}),e.jsx("input",{type:"range",min:"0",max:f,step:"0.1",value:m,onChange:e=>(e=>{if(h!==e){p(e);const t=e/100*i[0].duration;s.setTime(t),s.update(0)}x(e)})(parseFloat(e.target.value)),disabled:d,className:"w-full appearance-none bg-gray-800 h-1 rounded-lg cursor-pointer"})]})},{In:M}=y;function N({url:s="https://dbrhuu5ekb5pj.cloudfront.net/heart-v1.glb",modelRef:n,setModelLoaded:r}){const{animations:a,scene:i}=c.useGLTF(s),d=t.useMemo((()=>new l.AnimationMixer(i)),[i]),[u,m]=t.useState(1),[p,h]=t.useState(null),x=t.useMemo((()=>({})),[]);t.useEffect((()=>{if(d&&i&&n.current)return a.forEach((e=>{const t=d.clipAction(e,i);t.clampWhenFinished=!0,t.loop=l.LoopRepeat,x[e.name]=t})),()=>{d.stopAllAction()}}),[a,d,i,n,x]),t.useEffect((()=>{d.timeScale=u}),[u,d]),t.useEffect((()=>{n.current=i,r(i)}),[i,n,r]),o.useFrame(((e,t)=>{d.update(t)}));return e.jsxs(e.Fragment,{children:[e.jsx(M,{children:e.jsx(S,{animationSpeed:u,setAnimationSpeed:m,mixer:d,animations:Object.keys(x),playAction:(e,t)=>{const s=x[e];s&&(t?s.isRunning()||s.reset().fadeIn(.1).play():s.stop(),h(s))},anims:a})}),e.jsx("primitive",{object:i,ref:n})]})}const C=({url:s,openARView:n})=>{const{Out:d}=y,u=t.useRef(null),m=t.useRef(null),p=t.useRef(null),h=t.useRef(null),[f,g]=t.useState(!1);let v=(e=>{const t=new Date,s=`${t.getDate().toString().padStart(2,"0")}${t.getHours().toString().padStart(2,"0")}${t.getMinutes().toString().padStart(2,"0")}`,n=e.split("."),r=n.length>1?`.${n.pop()}`:"";return`${n.join(".")}_${s}${r}`})("preview");return function(e,s,n,r){t.useEffect((()=>{const t=()=>{if(!e.current||!s||!r)return;const{clientWidth:t,clientHeight:o}=e.current;new x.Vector3;const a=(new x.Box3).setFromObject(s).getSize(new x.Vector3).multiplyScalar(1);let i=Math.max(a.x,Math.max(a.y,a.z));i<1&&(i=2.7725857049414815),console.log("ðŸš€ ~ resizeHandler ~ maxSide:",i);const l=i/100,c=100*i;console.log("ðŸš€ ~ resizeHandler ~ defaultNear:",l,c);const d=Math.min(1,t/o),u=n.fov*Math.PI/180,m=Math.sqrt(a.x**2+a.y**2+a.z**2)/2;s.scale.set(1,1,1),s.position.set(0,-1*a.y/2,0),s.position.set(0,0,0);let p=m/Math.sin(u/2)/d*1.2;if(window.innerHeight<500&&(p+=2*(1-(window.innerHeight/500)**2)),n){n.aspect=t/o;const e=2.5*i;console.log("ðŸš€ ~ resizeHandler ~ distance:",e,Math.min(t,o)/(2*Math.tan(n.fov*Math.PI/360))),n.position.set(-p/2,-p/2,p),n.far=c,n.near=l,r.target.set(0,0,0),n.updateProjectionMatrix(),n.position.set(0,0,e)}if(console.log("ðŸš€ ~ resizeHandler ~ camera:",n),s){const e=window.innerWidth,t=window.innerHeight,n=Math.sqrt(e*e+t*t)/70;s.scale.set(n,n,n),s.position.set(0,-1*i/2,0)}console.log("ðŸš€ ~ resizeHandler ~ clientWidth, clientHeight:",s,r,e,n)};return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}),[e,s,n])}(u,m?.current,p?.current,h.current),e.jsxs(e.Fragment,{children:[e.jsx(a.Leva,{titleBar:{title:"Configuration"},collapsed:!0}),e.jsxs("div",{id:"canvas-container",className:"relative h-dvh",children:[e.jsxs(o.Canvas,{ref:u,onCreated:({scene:e})=>{e.background=new l.Color("#bfe3dd"),e.toneMapping=x.LinearToneMapping},antialias:!0,colorManagement:!0,sortObjects:!0,shadowMap:{enabled:!0},gl:{physicallyCorrectLights:!0,preserveDrawingBuffer:!0},style:{width:"100%",height:"100%"},shadows:!0,dpr:[1,1.5],camera:{position:[5,2,9],fov:40,near:1,far:100,quaternion:[0,0,0,1]},children:[e.jsx(j,{}),e.jsx(t.Suspense,{fallback:e.jsx(w,{}),children:e.jsx(N,{modelRef:m,setModelLoaded:g,url:s})}),e.jsx(c.PerspectiveCamera,{makeDefault:!0,ref:p,fov:40}),e.jsx(r.OrbitControls,{enablePan:!0,enableRotate:!0,enableZoom:!0,ref:h})]}),e.jsxs("div",{className:"w-full absolute bottom-0 flex justify-start items-center bg-black bg-opacity-50 p-4 rounded-t-lg gap-4",children:[e.jsx(d,{}),e.jsxs("button",{onClick:()=>{let[e]=document.getElementsByTagName("canvas");if(e){const t=e.toDataURL("image/png").replace("image/png","image/octet-stream");i(t,`${v.split(".")[0]}.png`)}},className:"flex gap-2 rounded bg-blue-500 px-4 py-2 font-bold text-white hover:bg-blue-700 justify-self-end",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})]}),e.jsx("span",{children:"Screenshot"})]}),e.jsxs("button",{onClick:n,className:"flex gap-2 rounded bg-blue-500 px-4 py-2 font-bold text-white hover:bg-blue-700 justify-self-end",children:[e.jsxs("svg",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",className:"w-6 h-6",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z"}),e.jsx("path",{d:"M10 21H8a2 2 0 01-2-2V5a2 2 0 012-2h8a2 2 0 012 2v3.5"}),e.jsx("path",{d:"M17 17l-4-2.5 4-2.5 4 2.5V19l-4 2.5z"}),e.jsx("path",{d:"M13 14.5V19l4 2.5M17 17l4-2.5M11 4h2"})]}),e.jsx("span",{children:"View AR"})]})]})]})]})},E=({onClose:t})=>{const s=window.location.pathname+(window.location.search?"&":"?")+"mode=qr";return e.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-gray-800 bg-opacity-50 p-20",children:e.jsxs("div",{className:"flex w-[70vw] flex-col justify-center rounded-lg bg-white shadow-lg relative p-5 h-[70vh] items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Scan QR Code for AR view"}),e.jsx("hr",{className:"border-t-2 border-gray-300 my-2 w-1/2"}),e.jsx("div",{className:"text-center border-2 border-gray-600 p-4 rounded-xl",children:e.jsx(p,{value:s})}),e.jsx("button",{onClick:t,className:"absolute right-0 top-0 px-4 py-2 font-bold text-black hover:bg-gray-700 hover:text-white",children:"X"})]})})};function R({url:s="https://dbrhuu5ekb5pj.cloudfront.net/ocean-v1.glb"}){const[n,r]=t.useState(!1),[o,a]=t.useState(!1),[i,l]=t.useState(!1);return t.useEffect((()=>{(async()=>{if("xr"in navigator)try{const e=await navigator.xr.isSessionSupported("immersive-ar");r(e)}catch(e){console.error("Error checking AR compatibility:",e),r(!1)}else r(!1)})()}),[]),t.useEffect((()=>{const e=document.createElement("script");return e.src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.0.1/model-viewer.min.js",e.type="module",document.head.appendChild(e),()=>{document.head.removeChild(e)}}),[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative flex w-full h-full",children:[i?e.jsx(g,{withAr:i,url:s}):e.jsx(C,{url:s,openARView:()=>{n?l(!0):a(!0)}}),o&&e.jsx(E,{onClose:()=>a(!1)})]})})}s.createRoot(document.getElementById("root")).render(e.jsx(t.StrictMode,{children:e.jsx((({url:t})=>e.jsx(R,{url:t})),{})}))}(jsxRuntime,React,ReactDOM,reactHelmet,OrbitControls,fiber,leva,saveAs,THREE,drei,clsx,tailwindMerge,tunnel,QRCode);
//# sourceMappingURL=modelViewer.min.js.map
